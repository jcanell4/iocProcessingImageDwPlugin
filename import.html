<script>
    require([
        "dojo/json"
                , 'dojo/_base/connect'
                , 'dojo/dom'
                , 'dojo/dom-construct'
                , 'dijit/registry'
                , 'dojo/parser'
                , 'dojo/domReady!'
                , 'dijit/form/Button'
                , 'dojox/form/Uploader'
                , "dijit/layout/TabContainer"
                , "dijit/layout/ContentPane"
                , "dojo/domReady!"
    ], function(JSON, cn, dom, domConst, registry, parser) {
        parser.parse();
        var uploader = registry.byId("uploader");

        var handleUpload = function(upl, node) {
            cn.connect(upl, "onComplete", function(data) {
                //var json = JSON.parse(data, false);
                var div = domConst.create('div', {className: 'thumb'});
                var span = domConst.create('span', {className: 'thumbbk'}, div);
                span.innerHTML = "<p> type: " + data[0].type + "</p>"
                        + "<p> value: " + JSON.stringify(data[0].value) + "</p>"

                node.appendChild(div);
            });
        };
        var handleDnD = function(domnode, uploader) {
            if (uploader.addDropTarget && uploader.uploadType == 'html5') {
                domConst.create('div', {innerHTML: 'Drag and Drop files to this fieldset'}, domnode, 'last');
                uploader.addDropTarget(domnode);
            }
        };

        cn.connect(registry.byId("remBtn"), "onClick", uploader, "reset");
        //cn.connect(registry.byId("submit"), "onClick", uploader, "submit");
        handleUpload(uploader, dom.byId('response'));
        if (require.has('file-multiple')) {
            handleDnD(uploader.domNode.parentNode, uploader);
        }
    });
</script>  
<div id="import">
    <form id="f1" name="f1" method="post" action="/dokuwiki/lib/plugins/ajaxcommand/ajax.php?call=commandreport" enctype="multipart/form-data">
        <fieldset>
            <legend>Inline Browse Button Form Post Test</legend>
            inline control <div data-dojo-type="dojox/form/Uploader" id="uploader" data-dojo-props="name:'uploadedfile',showInput:'before',isDebug:true">Browse</div>
            <input type="text" name="album" value="Summer Vacation" aria-label="album" />
            <input type="text" name="year" value="2011" aria-label="year" />
            <input type="button" id="remBtn" label="Clear" data-dojo-type="dijit/form/Button" />
            <input type="submit" id="submit" label="Submit" data-dojo-type="dijit/form/Button" />
        </fieldset>
    </form>
    <div id="response"></div>
</div>

